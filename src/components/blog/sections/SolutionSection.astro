---
import type { SolutionSection, Language } from '../../../types/blog';

interface Props {
  section: SolutionSection;
  lang: Language;
}

const { section, lang } = Astro.props;
const title = section.title?.[lang];
---

<section class="blog-section blog-section--solution" id={section.id}>
  {title && <h2 class="blog-section__title">{title}</h2>}
  
  <div class="blog-section__subsections">
    {section.subsections.map((subsection) => {
      const subTitle = subsection.title[lang];
      const subContent = subsection.content[lang];
      const image = subsection.image;
      const code = subsection.code;
      
      return (
        <div class="subsection" id={subsection.id}>
          <h3 class="subsection__title">{subTitle}</h3>
          <div class="subsection__content" set:html={subContent.text} />
          
          {image && (
            <figure class="subsection__figure">
              <img 
                src={image.src} 
                alt={image.alt[lang]}
                width={image.width}
                height={image.height}
                class="subsection__image"
                loading="lazy"
              />
              {image.caption && (
                <figcaption class="subsection__caption">
                  {image.caption[lang]}
                </figcaption>
              )}
            </figure>
          )}
          
          {code && (
            <figure class="subsection__code-block">
              <pre><code class={`language-${code.language}`}>{code.code}</code></pre>
              {code.caption && (
                <figcaption class="subsection__caption">
                  {code.caption[lang]}
                </figcaption>
              )}
            </figure>
          )}
        </div>
      );
    })}
  </div>
</section>

<style>
  .blog-section--solution {
    margin-bottom: 3rem;
  }

  .blog-section__title {
    font-size: 2rem;
    font-weight: 700;
    color: #0f172a;
    margin-bottom: 2rem;
    line-height: 1.3;
    letter-spacing: -0.02em;
  }

  .blog-section__subsections {
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .subsection {
    scroll-margin-top: 2rem;
  }

  .subsection__title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #0f172a;
    margin-bottom: 1.25rem;
    line-height: 1.3;
    letter-spacing: -0.02em;
  }

  .subsection__content {
    font-size: 1.125rem;
    line-height: 1.8;
    color: #1e293b;
    margin-bottom: 1.5rem;
  }

  .subsection__content :global(p) {
    margin-bottom: 1.5rem;
  }

  .subsection__figure {
    margin: 2.5rem 0;
  }

  .subsection__image {
    width: 100%;
    height: auto;
    border-radius: 8px;
    display: block;
  }

  .subsection__code-block {
    margin: 2rem 0;
  }

  .subsection__code-block pre {
    background: #1e293b;
    color: #f1f5f9;
    padding: 1.5rem;
    border-radius: 8px;
    overflow-x: auto;
    font-size: 0.95rem;
  }

  .subsection__code-block code {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  }

  .subsection__caption {
    text-align: center;
    font-size: 0.875rem;
    color: #64748b;
    margin-top: 0.75rem;
    font-style: italic;
  }
</style>
